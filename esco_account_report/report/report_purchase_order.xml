<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <template id="esco_report_purchaseorder_document">
        <t t-call="esco_account_report.external_layout_bait">
            <t t-set="o" t-value="o.with_context(lang=o.env.lang or o.partner_id.lang)" />
            <div class="page page_margin" style="font-family: Frutiger_Light; font-size: 17px;">
                <t t-if="o.sudo().dest_address_id">
                </t>
                <span class="bold_header">Purchase Order</span>
                <div class="row" style="width: 100%; ">
                    <table
                        style="width: 48%; margin-right: 4%; border-collapse: collapse; border: none; table-layout: fixed;">
                        <tr>
                            <td style="width:28%;">
                                <span>PO. No.</span>
                            </td>
                            <td style="width:72%;"
                                class="text-center top_border left_border right_border">
                                <span t-field="o.name" style="margin-left: 15px; margin-right: 15px;" />
                            </td>
                        </tr>
                        <tr>
                            <td style="width:28%;">
                                <span>Date</span>
                            </td>
                            <td style="width:72%; "
                                class="text-center top_border left_border right_border bottom_border">
                                <span t-field="o.order_date" style="margin-left: 25px; margin-right: 15px;" />
                            </td>
                        </tr>
                    </table>
                    <div style="width: 5%;">
                    </div>
                    <div style="width: 43%; text-align: left; ">
                        <table
                            style="width: 100%; border-collapse: collapse; border: none; float: right;">
                            <thead>
                                <tr>
                                    <td
                                        class="table_header text-left top_border left_border right_border bottom_border">
                                        <span style="margin-left: 2%; margin-right: 2%;">Vendor</span>
                                    </td>
                                </tr>
                            </thead>
                        </table>
                        <div style="direction: ltr;">
                            <div class="float: left;"
                                style="border: none;padding-top: 5px;margin-top: 5px;">
                                <div style="margin-top: 20px;">
                                    <br />
                                    <t t-esc="o.sudo().partner_id.name" />
                                </div>
                                <div style="padding-top: 5px;margin-top: 5px;">
                                    <t t-if="o.partner_id.city">
                                        <span t-field="o.partner_id.city" />
                                    </t>
                                    <span>&#160;</span>
                                    <t t-if="o.partner_id.state_id">
                                        <span t-field="o.partner_id.state_id.name" />
                                    </t>
                                </div>
                            </div>
                            <div class="row" style="border: none; margin-right: 1%;">
                                <span>ID No.</span>
                                <span>&#160;</span>
                                <div class="text-center"
                                    style="width: 85%;height: 25px; border: 1px solid grey;">
                                    <span t-field="o.partner_id.id" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <br />
                <table class="table table-sm table_with_header"
                    style="border-collapse: collapse; border-color: grey;">
                    <thead style="background-color: #30378c !important;">
                        <tr>
                            <td class="table_header text-center">
                                <span>Payment</span>
                            </td>
                            <td class="table_header text-center">
                                <span>Delivery Date</span>
                            </td>
                            <td class="table_header text-center">
                                <span>Conditions Terms</span>
                            </td>
                            <td class="table_header text-center">
                                <span>Shipping to</span>
                            </td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background-color: white !important;">
                            <td class="text-center">
                                <span style="color: white">1</span>
                                <span t-field="o.payment_type_id" />
                            </td>
                            <td class="text-center">
                                <span t-field="o.delivery_date" />
                            </td>
                            <td class="text-center">
                                <span t-field="o.condition_term_id" />
                            </td>
                            <td class="text-center" style="background-color: white !important;">
                                <span t-field="o.shipping_data_id" />
                            </td>
                        </tr>
                    </tbody>
                </table>
                <br />
                <t t-set="i" t-value="1" />
                <table class="table table-sm table_with_header"
                    style="border-collapse: collapse; table-layout: fixed; border-color: grey;">

                    <thead style="background-color: #30378c;">
                        <tr>
                            <td style="width: 11%;" class="table_header">
                                <span>No.</span>
                            </td>
                            <td style="width: 46%;" class="table_header text-center">
                                <span>Description</span>
                            </td>
                            <td style="width: 21%;" class="table_header text-center">
                                <span>QTY</span>
                            </td>
                            <td style="width: 14%;" class="table_header text-center">
                                <span>Unit Price</span>
                            </td>
                            <td style="width: 19%;" class="table_header text-center">
                                <span>Total</span>
                            </td>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-set="current_subtotal" t-value="0" />
                        <t t-set="line_count" t-value="0" />
                        <t t-foreach="o.order_line" t-as="line">
                            <t t-set="current_subtotal"
                                t-value="current_subtotal + line.price_subtotal" />
                            <t t-if="not line.display_type">
                                <t t-set="line_count" t-value="line_count + 1" />
                            </t>

                            <tr
                                t-att-class="'bg-200 fw-bold o_line_section' if line.display_type == 'line_section' else 'fst-italic o_line_note' if line.display_type == 'line_note' else ''">
                                <td class="text-center">
                                    <t t-if="not line.display_type">
                                        <span t-esc="line_count" />
                                    </t>
                                    <t t-else="">
                                        <span>-</span>
                                    </t>
                                </td>
                                <t t-if="not line.display_type">
                                    <td id="product">
                                        <span t-field="line.name" />
                                    </td>
                                    <td class="text-center">
                                        <span t-field="line.product_qty" />
                                        <span t-field="line.product_uom.name" groups="uom.group_uom" />
                                        <span t-if="line.product_packaging_id"> (<span
                                                t-field="line.product_packaging_qty"
                                                t-options='{"widget": "integer"}' /> <span
                                                t-field="line.product_packaging_id" />) </span>
                                    </td>
                                    <td class="text-center">
                                        <span t-field="line.price_unit" />
                                    </td>
                                    <td>
                                        <div style="position:relative;">
                                            <!-- Align currency symbol to the left -->
                                            <div t-esc="line.currency_id.symbol" style="left:0; position:absolute;"/>

                                            <!-- Center the price_subtotal -->
                                            <div t-esc="line.price_subtotal" style="position:absolute;left:25%;"/>
                                        </div>
                                    </td>
                                </t>
                                <t t-if="line.display_type == 'line_section'">
                                    <td colspan="99" id="section">
                                        <span t-field="line.name" />
                                    </td>
                                    <t t-set="current_section" t-value="line" />
                                    <t t-set="current_subtotal" t-value="0" />
                                </t>
                                <t t-if="line.display_type == 'line_note'">
                                    <td colspan="99" id="note">
                                        <span t-field="line.name" />
                                    </td>
                                </t>
                            </tr>
                            <t
                                t-if="current_section and (line_last or o.order_line[line_index+1].display_type == 'line_section')">
                                <tr class="is-subtotal text-center">
                                    <td colspan="99" id="subtotal">
                                        <strong class="mr16">Subtotal</strong>
                                        <span
                                            t-esc="current_subtotal"
                                            t-options='{"widget": "monetary", "display_currency": o.currency_id}'
                                        />
                                    </td>
                                </tr>
                            </t>
                        </t>
                    </tbody>
                </table>

                <div class="row justify-content-end "
                    style="margin-right: 0px; margin-top: -5px; border-color: grey;">
                    <table style="width: 29.8%; margin-left: 2%;border: 1px black solid; ">
                        <tr>
                            <td style="padding-left: 10px !important;border: 1px black solid;">
                                <span>Subtotal</span>
                            </td>

                            <td style="width: 141px !important;border: 1px black solid;">
                                <div style="position:relative;">
                                    <!-- Align currency symbol to the left -->
                                    <div t-esc="o.currency_id.symbol" style="left:0; position:absolute;"/>

                                    <div t-esc="o.amount_total" style="position:absolute;left:25%;"/>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td style="padding-left: 10px !important;border: 1px black solid;">
                                <span>Other</span>
                            </td>
                            <td class="text-center" style="border: 1px black solid;">
                                <span>-</span>
                            </td>
                        </tr>
                        <tr>
                            <td style="padding-left: 10px !important;border: 1px black solid;">
                                <br />
                                <span class="bold_text">Total</span>
                            </td>
                            <td class="bold_text" style="border: 1px black solid;">
                                <br />
                                <div style="position:relative;">
                                    <!-- Align currency symbol to the left -->
                                    <div t-esc="o.currency_id.symbol" style="left:0; position:absolute;"/>

                                    <div t-esc="o.amount_total" style="position:absolute;left:25%;"/>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
                <br />
                <div class="text-center row col-12"
                    style="margin-left:5mm;margin-right:5mm;margin-top: 50px; font-size: 16px;">
                    <div class="col-4">
                        <!--  Signature-->
                        <div style="height:140px; min-height:140px;">
                            <img t-if="o.validated_by_id.signature_image"
                                t-att-src="image_data_uri(o.validated_by_id.signature_image)"
                                alt="Signature" style="height:140px;width:260px; margin-top: -30px;" />
                        </div>
                        <hr style="border-color: black; margin-top: -30px;" />
                        <span t-field="o.validated_by_id" />
                    </div>
                    <div class="col-4">
                    </div>
                    <div class="col-4">
                    </div>
                </div>
            </div>
        </t>
    </template>

    <template id="purchase.report_purchaseorder">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="esco_account_report.esco_report_purchaseorder_document" />
            </t>
        </t>
    </template>

</odoo>